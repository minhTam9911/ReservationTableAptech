<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" layout:decorate="~{layout/customer}"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"    xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
	<title>Dinner table details Page</title>
<style>
		#map {
			height: 320px;
			width: 100%;
		}

		/* Hide the images by default */

		.location-info {
			display: flex;
			align-items: center;
		}

		.location-info .fa-location-dot {
			font-size: 24px;
			/* Điều chỉnh kích thước của biểu tượng */
			margin-right: 5px;
			/* Điều chỉnh khoảng cách giữa biểu tượng và văn bản */
			color: #1e90ff;
			/* Thiết lập màu xanh dương là màu mặc định */
			transition: color 0.3s ease;
			/* Thêm hiệu ứng chuyển đổi màu */
		}

		.icon-blue:hover {
			color: #ff0000;
			/* Khi hover vào biểu tượng, đổi màu thành màu đỏ */
		}

		/* Six columns side by side */
		.row {
			display: flex;
			/* Sử dụng flexbox để căn chỉnh các cột */
			flex-wrap: wrap;
			/* Cho phép các cột wrap khi không đủ không gian */
			justify-content: center;
		}

		.mySlides {
			display: none;
		}

		.column {
			flex-basis: calc(16.66% - 20px);
			/* Đặt kích thước cố định cho mỗi cột và định cấu trúc giữa chúng */
			margin-bottom: 20px;
			/* Tạo khoảng cách giữa các cột */
			margin-right: 2px;

		}

		/* Add a pointer when hovering over the thumbnail images */
		.cursor {
			cursor: pointer;
		}

		/* Next & previous buttons */
		.prev,
		.next {
			cursor: pointer;
			position: absolute;
			top: 88%;
			width: auto;
			padding: 16px;
			margin-top: -50px;
			color: white;
			font-weight: bold;
			font-size: 20px;
			border-radius: 0 3px 3px 0;
			user-select: none;
			-webkit-user-select: none;
		}

		/* Position the "next button" to the right */
		.next {
			right: 275px;
			border-radius: 3px 0 0 3px;
		}

		/* On hover, add a black background color with a little bit see-through */
		.prev:hover,
		.next:hover {
			background-color: rgba(0, 0, 0, 0.8);
		}

		/* Number text (1/3 etc) */
		.numbertext {
			color: #f2f2f2;
			font-size: 12px;
			padding: 8px 12px;
			position: absolute;
			top: 0;
		}

		/* Container for image text */
		.caption-container {
			text-align: center;
			background-color: #222;
			padding: 2px 16px;
			color: white;
		}

		/* Add a transparency effect for thumnbail images */
		.demo {
			opacity: 0.6;
		}

		.active,
		.demo:hover {
			opacity: 1;
		}
	</style>
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet" />

</head>

<body>

	<section layout:fragment="content">
		<!--================Breadcrumb Area =================-->
		<section class="breadcrumb_area">
			<div class="overlay bg-parallax" data-stellar-ratio="0.8" data-stellar-vertical-offset="0"
				data-background=""></div>
			<div class="container">
				<div class="page-cover text-center">
					<h2 class="page-cover-tittle">For more information
					</h2>
					<ol class="breadcrumb">
						<li><a th:href="@{/customer/dinnerTables}">Dinner Tables</a></li>
						<li class="active">Dinner Table Details</li>
					</ol>
				</div>
			</div>
		</section>
		<!--================Breadcrumb Area =================-->
		<div class="container">
			<h1>Dinner Table Details</h1>
			<div th:each="image, iterStat : ${dinnerTable.imagesDto}" class="mySlides">
				<div class="numbertext" th:text="${iterStat.index + 1} + ' / ' + ${dinnerTable.imagesDto.size()}"></div>
				<img th:src="@{/uploads/dinnerTables/{imageName}(imageName=${image.path})}"
					style="width:100%;height: 523px;margin-bottom: 15px;">
			</div>
			<!-- Thumbnail images -->
			<div class="row">
				<!-- Iterate over imagesDto and generate thumbnail images -->
				<div th:each="image, iterStat : ${dinnerTable.imagesDto}" class="column">
					<img class="demo cursor" th:src="@{/uploads/dinnerTables/{imageName}(imageName=${image.path})}"
						style="width:100%;height: 160px;" th:onclick="'currentSlide(' + ${iterStat.index + 1} + ')'"
						th:alt="Image">
				</div>
			</div>
			<a class="prev" onclick="plusSlides(-1)">&#10094;</a>
			<a class="next" onclick="plusSlides(1)">&#10095;</a>
		</div>

		<div class="container" style="
    margin-bottom: 33px;">
			<div class="details-display d-flex justify-content-between">
				<div class="card">
					<div class="card-body" style="width:350px;box-shadow:0px 0px 12px rgba(0, 0, 0, 0.1);">
						<h5 class="card-title">Table Details</h5>
						<h6 class="card-subtitle mb-2 text-muted" th:text="'Table ID: ' + ${dinnerTable.id}"></h6>
						<p class="card-text" th:text="'Table Quantity: ' + ${dinnerTable.quantity}"></p>
						<p class="card-text" th:text="'Table Type: ' + ${dinnerTable.dinnerTableTypeDto.type}"></p>
						<p class="card-text" th:text="'Restaurant Name: ' + ${dinnerTable.restaurantDto.name}"></p>
					</div>
				</div>
				<div class="card">
					<div class="card-body" style="width:350px;box-shadow:0px 0px 12px rgba(0, 0, 0, 0.1);">
						<h5 class="card-title">Location and contact information</h5>
						<div id="map"></div>
						<div class="location-info">
							<i class="fa-solid fa-location-dot larger icon-blue"></i>
							<p class="card-text" th:text="${dinnerTable.restaurantDto.getFullAddress()}"></p>
						</div>


					</div>
				</div>
				<div class="card">
					<div class="card-body" style="width: 350px; box-shadow: 0px 0px 12px rgba(0, 0, 0, 0.1);">
						<div class="booking-form">
							<h3 class="card-title">Reserve your table</h3>
							<form action="/customer/reservation/submit" method="post">
								<div class="form-group">
									<label for="booking-date">Booking Date:</label>
									<input type="date" name="date" class="form-control" id="booking-date" required
										style="padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
								</div>
								<div class="form-group">
									<label for="booking-time">Booking Time:</label>
									<input type="time" name="time" class="form-control" id="booking-time" required
										style="padding: 5px; border: 1px solid #ccc; border-radius: 4px;">
								</div>
								<div class="input-group" style="flex-direction: column;">
									<label>Party size:</label>
									<select class="wide" name="partySize" style="display: none;">
										<option value="1" >1 People</option>
										<th:block th:each="i : ${#numbers.sequence(2, 10)}">
											<option th:value="${i}" th:text="${i} + ' Peoples'"></option>
										</th:block>
									</select>
								</div>
								<div class="input-group" style="flex-direction: column;">
									<label>Payment method:</label>
									<select class="wide" name="method" style="display: none;">
										<option value="1">Paypal</option>
										<option value="2">VNPay</option>
									</select>

								</div><input type="hidden" name="idDinnerTable" th:value="${dinnerTable.id}">
								<br>
								<button sec:authorize="isAuthenticated() and hasAnyAuthority('ROLE_CUSTOMER')" type="submit" class="btn btn-primary"
									style="padding: 10px 20px; background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer;">Book</button>
								<button sec:authorize="!isAuthenticated()" type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
 										 Booking
									</button>
							</form>
						</div>
					</div>
				</div>
			</div>
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Warning</h5>
        <button type="button" style="border: 0;background-color: white;" class="btn-close" data-bs-dismiss="modal" aria-label="Close"><i class="fa-solid fa-xmark"></i></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <a href="/login" type="button" class="btn btn-primary">Login</a>
      </div>
    </div>
  </div>
</div>
			<!-- Phần comment -->
			<div class="comment-section">
				<h2>Comments</h2>

				<!-- Form comment -->
				<form>
					<div class="form-group">
						<label for="comment">Comment & Rating:</label>
						<textarea class="form-control" id="comment" rows="3"
							placeholder="Enter your comment"></textarea>
					</div>
					<button type="submit" class="btn btn-primary">Submit</button>
				</form>
			</div>

		</div>
		<script>
			document.addEventListener("DOMContentLoaded", function () {
				// Hiển thị slide đầu tiên
				showSlides(slideIndex);
			});

			function showSlides(n) {
				let i;
				let slides = document.getElementsByClassName("mySlides");
				let dots = document.getElementsByClassName("demo");
				if (n > slides.length) {slideIndex = 1}
				if (n < 1) {slideIndex = slides.length}
				for (i = 0; i < slides.length; i++) {
					slides[i].style.display = "none";
				}
				for (i = 0; i < dots.length; i++) {
					dots[i].className = dots[i].className.replace(" active", "");
				}
				slides[slideIndex - 1].style.display = "block"; // Thiết lập slide hiển thị
				if (dots.length > 0) { // Kiểm tra xem có dots không để tránh lỗi
					dots[slideIndex - 1].className += " active";
				}
			}

			let slideIndex = 1;
			// showSlides(slideIndex); // Bỏ dòng này vì đã gọi trong DOMContentLoaded

			// Các hàm next/previous
			function plusSlides(n) {
				showSlides(slideIndex += n);
			}

			// Các hàm điều khiển thumbnail
			function currentSlide(n) {
				showSlides(slideIndex = n);
			}

			mapboxgl.accessToken = 'pk.eyJ1IjoibXktdXNlcm5hbWUxMjMiLCJhIjoiY2x0bnVnMmcyMGF1aTJsbW52dG9ueHM1MSJ9.X8FX0jbH1HR15xi7Y0U7tw';

			var map = new mapboxgl.Map({
				container: 'map',
				style: 'mapbox://styles/mapbox/streets-v11',
				center: [-74.5, 40],
				zoom: 9
			});

			// Add Google Maps overlay
			var googleMapOverlay = document.createElement('iframe');
			googleMapOverlay.setAttribute('src', 'https://www.google.com/maps/embed/v1/place?key=pk.eyJ1IjoibXktdXNlcm5hbWUxMjMiLCJhIjoiY2x0bnVnMmcyMGF1aTJsbW52dG9ueHM1MSJ9.X8FX0jbH1HR15xi7Y0U7tw&q=' + encodeURIComponent(dinnerTable.restaurantDto.getFullAddress()));
			googleMapOverlay.setAttribute('width', '100%');
			googleMapOverlay.setAttribute('height', '320px');
			googleMapOverlay.style.border = '0';


			map.on('load', function () {
				map.getCanvasContainer().appendChild(googleMapOverlay);
			});

		</script>
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
	</section>

</body>

</html>